<div class="jitsi-video-wrapper" [class.dark-theme]="isDarkTheme">
  <!-- Mobile App Prompt (Android/iOS) para Split-Screen -->
  <div class="mobile-app-prompt" *ngIf="showMobileAppPrompt && !isLoading">
    <div class="prompt-content">
      <div class="prompt-icon">
        <app-icon name="smartphone" [size]="64" />
      </div>
      <h3>Abra o App Jitsi Meet e cole:</h3>
      
      <div class="url-to-copy large">
        <code class="server-url room-name">{{ token?.publicRoomName }}</code>
        <button class="copy-btn" (click)="copyPublicRoomName()" title="Copiar">
          <app-icon name="copy" [size]="16" />
          Copiar
        </button>
      </div>
      
      <p class="tip">⚠️ <em>Médico e paciente devem usar o MESMO código acima!</em></p>
      
      <div class="prompt-actions">
        <app-button variant="secondary" (click)="continueInBrowser()">
          <app-icon name="globe" [size]="18" />
          Usar Navegador (sem compartilhamento)
        </app-button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Conectando à videochamada...</p>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-overlay" *ngIf="errorMessage && !isLoading">
    <div class="error-content">
      <app-icon name="alert-circle" [size]="48" />
      <h3>Erro na Videochamada</h3>
      <p>{{ errorMessage }}</p>
      <app-button variant="primary" (click)="retry()">
        <app-icon name="refresh-cw" [size]="18" />
        Tentar Novamente
      </app-button>
    </div>
  </div>

  <!-- Jitsi Container -->
  <div 
    #jitsiContainer
    id="jitsi-meet-container"
    class="jitsi-container"
    [class.hidden]="isLoading || errorMessage">
  </div>

  <!-- Status Bar Only (controles usam a toolbar nativa do Jitsi) -->
  <div class="status-overlay" *ngIf="showControls && isConnected && !errorMessage">
    <div class="status-bar">
      <div class="connection-status" [class.connected]="isConnected">
        <span class="status-dot"></span>
        <span>{{ isConnected ? 'Conectado' : 'Desconectado' }}</span>
      </div>
      <div class="participant-count" *ngIf="participantCount > 0">
        <app-icon name="users" [size]="14" />
        <span>{{ participantCount }} participante{{ participantCount !== 1 ? 's' : '' }}</span>
      </div>
      <div class="moderator-badge" *ngIf="isModerator">
        <app-icon name="shield" [size]="14" />
        <span>Moderador</span>
      </div>
    </div>
  </div>
</div>
